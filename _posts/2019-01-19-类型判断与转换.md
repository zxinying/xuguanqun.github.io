---
layout: post
title:  "js-运算符"
author: xuguanqun
categories: [ 重学JavaScript ]
image: assets/images/js.jpg
---

## 四则运算符
>`+ - * /`  

加法运算符不同于其他几个运算符，它有以下几个特点：

+ 运算中其中一方为字符串，那么就会把另一方也转换为字符串
+ 如果一方不是字符串或者数字，那么会将它转换为数字或者字符串
```
1 + '1' // '11'
true + true // 2
4 + [1,2,3] // "41,2,3"
```
如果你对于答案有疑问的话，请看解析：

对于第一行代码来说，触发特点一，所以将数字 1 转换为字符串，得到结果 '11'   
对于第二行代码来说，触发特点二，所以将 `true` 转为数字 1   
对于第三行代码来说，触发特点二，所以将数组通过 `toString` 转为字符串 1,2,3，得到结果 41,2,3   
另外对于加法还需要注意这个表达式 `'a' + + 'b'`

`'a' + + 'b' // -> "aNaN"`   
因为 + 'b' 等于 `NaN`，所以结果为 "aNaN"，你可能也会在一些代码中看到过 + '1' 的形式来快速获取 `number` 类型。

那么对于除了加法的运算符来说，只要其中一方是数字，那么另一方就会被转为数字
```
4 * '3' // 12
4 * [] // 0
4 * [1, 2] // NaN
```
## 比较和逻辑运算符
比较和逻辑运算符用于测试 `true` 或 `false`
### 比较运算符
>`> < >= <= == === != !==`   

如果是对象，就通过 `toPrimitive` 转换对象  
如果是字符串，就通过 `unicode` 字符索引来比较
```
let a = {
  valueOf() {
    return 0
  },
  toString() {
    return '1'
  }
}
a > -1 // true
```
在以上代码中，因为 a 是对象，所以会通过 `valueOf` 转换为原始类型再比较值。

**`==` 与 `===` 的区别**

假如我们使用 `==` 来比较 `x` 与 `y` 是否相同，就会进入下面的判断流程：

1.判断两者类型是否相同，如果相同则比大小  
2.如果类型不同，将会进行类型转换，转换成相同类型后进行比较  
3.判断是否在对比 `null` 与 `undefined`，如果是的话直接返回 `true`  
4.判断两者类型是否为 `string` 与 `string`，如果是的话会将 `string` 转为 `number`    
5.判断其中一方是否为 `boolean`，是的话就会把 `boolean` 转为 number 再进行判断  
6.判断其中一方是否为 `object` 且另一方为 `string`、`number` 或者 `symbol`，是的话就会把 `object` 转为原始类型再进行判断

而如果我们使用 `===` 来比较 `x` 与 `y` 是否相同，就是判断两者类型和值是否相同，有一个不相同就会返回 `false`

所以 `==` 和 `===` 的区别就是 `==` 会进行类型的转换。
### 逻辑运算符
>`&& || !`  

| 运算符 | 语法 | 说明 |
|:--------:|:------:|:----:|
|逻辑与，AND（&&） |	expr1 && expr2	|若 expr1 可转换为 true，则返回 expr2；否则，返回 expr1。         |
|逻辑或，OR（\|\|）|expr1 \|\| expr2	|若 expr1 可转换为 true，则返回 expr1；否则，返回 expr2。         |
|逻辑非，NOT（!）  |!expr               |	若 expr 可转换为 true，则返回 false；否则，返回 true。|

## 位运算符
> `| & ~ ^`  
### 位运算符的应用
+ 判断奇偶数

```
num & 1 === 1 // num 为奇数
num & 1 === 0 // num 为偶数
```
因为二进制的奇数最低位是1，偶数最低位是0，& 1运算后可以判断奇偶，速度与 `%2判断奇偶数` 差不多。

+ 取整

```
~~3.14159 // 3
3.14159 >> 0 // 3
3.14159 >>> 0 // 3
3.14159 | 0 // 3
```
'>>>'不用于对负数取整,其他都可以

+ 比较值是否相等

`^` 也会将字符串类型的数字转换成数字后进行运算，相当于 `==`
```
1 ^ 1 //0
```
与 `==` 相比，`^` 的效率更高一些，但可读性差一些。
+ 变量值为数字时，完成值的交换

a ^= b 等同于 a = a ^ b
```
var a = 1 , b = 2
a ^= b
b ^= a
a ^= b
console.log(a) // 2
console.log(b) // 1
```
+ RGB值和16进制颜色值的转换
```
//16进制转RGB
function hexToRGB(hex){
    var hex = hex.replace("#","0x"),
        r = hex >> 16,
        g = hex >> 8 & 0xff,
        b = hex & 0xff;
    return "rgb("+r+","+g+","+b+")";
}
```
```
//RGB转16进制
function RGBToHex(rgb){
    var rgbArr = rgb.split(/[^\d]+/),
        color = rgbArr[1]<<16 | rgbArr[2]<<8 | rgbArr[3];
    return "#"+color.toString(16);
}
```
